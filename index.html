<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>e-curtain</title>
    <meta name="author" content="b1f6c1c4,paperneko">
    <link rel="stylesheet" href="/index.css">
</head>
<body>
    <input id="time" type="input" value="now">
    <input id="open" type="button" value="Open">
    <input id="close" type="button" value="Close">
    <input id="cancel" type="button" value="Cancel All">
    <pre id="result"></pre>
    <script>
        const time = document.getElementById('time');
        const btnO = document.getElementById('open');
        const btnC = document.getElementById('close');
        const btnX = document.getElementById('cancel');
        const res = document.getElementById('result');
        const orsc = function () {
            if (this.readyState === 4) {
                time.disabled = false;
                btnO.disabled = false;
                btnC.disabled = false;
                btnX.disabled = false;
                res.innerText = this.status + ' ' + this.statusText + '\n\n' + this.responseText;
            }
        };
        btnO.onclick = () => {
            const xhr = new XMLHttpRequest();
            xhr.open('POST', '/open', true);
            xhr.onreadystatechange = orsc;
            time.disabled = true;
            btnO.disabled = true;
            btnC.disabled = true;
            btnX.disabled = true;
            xhr.send(time.value);
        };
        btnC.onclick = () => {
            const xhr = new XMLHttpRequest();
            xhr.open('POST', '/close', true);
            xhr.onreadystatechange = orsc;
            time.disabled = true;
            btnO.disabled = true;
            btnC.disabled = true;
            btnX.disabled = true;
            xhr.send(time.value);
        };
        btnX.onclick = () => {
            const xhr = new XMLHttpRequest();
            xhr.open('POST', '/cancel', true);
            xhr.onreadystatechange = orsc;
            time.disabled = true;
            btnO.disabled = true;
            btnC.disabled = true;
            btnX.disabled = true;
            xhr.send(null);
        };
    </script>
</body>
</html>
